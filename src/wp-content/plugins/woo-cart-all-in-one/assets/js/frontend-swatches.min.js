jQuery.fn.viwcaio_get_variations=function(t){return new viwcaio_get_variation(this,t),this};var viwcaio_get_variation=function(t,i){this.wc_ajax_url=i.wc_ajax_url||"",this.form=t,this.product_id=parseInt(t.data("product_id")),this.variations=t.data("product_variations")||"",this.is_ajax=!this.variations,this.xhr=!1;let a={};t.on("viwcaio_check_variations",{viwcaio_get_variation:this},this.find_variation),t.on("change","select",{viwcaio_get_variation:this},this.onChange),t.find("select").each(function(){a[jQuery(this).data("attribute_name")]=jQuery(this).val()||""}),this.current_attr=a,setTimeout(function(){t.trigger("viwcaio_check_variations")},100)};viwcaio_get_variation.prototype.onChange=function(t){let i=t.data.viwcaio_get_variation,a=i.form;a.find('input[name="variation_id"], input.variation_id').val("").trigger("change"),i.current_attr[jQuery(this).data("attribute_name")]=jQuery(this).val()||"",i.is_ajax?a.trigger("viwcaio_check_variations"):(a.trigger("woocommerce_variation_select_change"),a.trigger("viwcaio_check_variations")),a.trigger("woocommerce_variation_has_changed")},viwcaio_get_variation.prototype.find_variation=function(t){let i=t.data.viwcaio_get_variation,a=null,e=!1,o=i.current_attr,n=i.form,r=i.variations;if(jQuery.each(o,function(t,i){if(!i)return e=!0,!1}),e)return i.update_attributes(o,r,n,i),i.show_variation(i,null,n),!1;i.is_ajax?(i.xhr&&i.xhr.abort(),r?(jQuery.each(r,function(t,e){if(i.check_is_equal(o,e.attributes))return a=e,!1}),a?i.show_variation(i,a,n):r.length<parseInt(n.data("variation_count")||0)?i.call_ajax(o,r,n,i):i.show_variation(i,null,n)):(r=[],i.call_ajax(o,r,n,i))):(jQuery.each(r,function(t,e){if(i.check_is_equal(o,e.attributes))return a=e,!1}),i.update_attributes(o,r,n,i),i.show_variation(i,a,n))},viwcaio_get_variation.prototype.update_attributes=function(t,i,a,e){if(e.is_ajax)return!1;a.find("select").each(function(a,o){let n,r=jQuery(o),c=r.data("attribute_name")||r.attr("name"),_=r.data("show_option_none"),s=r.val()||"",l=!0,d=jQuery("<select/>"),v=":gt(0)";if(!r.data("attribute_html")){let t=r.clone();t.find("option").removeAttr("disabled attached selected"),r.data("attribute_options",t.find("option"+v).get()),r.data("attribute_html",t.html())}d.html(r.data("attribute_html"));let u=jQuery.extend(!0,{},t);u[c]="";let h=[];for(let t=0;t<i.length;t++){let a=i[t];e.check_is_equal(u,a.attributes)&&h.push(a)}for(let t in h){if(void 0===h[t])continue;let i=h[t].attributes;for(let a in i){if(!i.hasOwnProperty(a))continue;let e=i[a],o="";if(a===c)if(h[t].variation_is_active&&(o="enabled"),e){e=jQuery("<div/>").html(e).text();let t=d.find("option");if(t.length)for(let i=0,a=t.length;i<a;i++){let a=jQuery(t[i]);if(e===a.val()){a.addClass("attached "+o);break}}}else d.find("option:gt(0)").addClass("attached "+o)}}n=d.find("option.attached").length,s&&(l=!1,0!==n&&d.find("option.attached.enabled").each(function(){var t=jQuery(this).val();if(s===t)return l=!0,!1})),n>0&&s&&l&&"no"===_&&(d.find("option:first").remove(),v=""),d.find("option"+v+":not(.attached)").remove(),r.html(d.html()),r.find("option"+v+":not(.enabled)").prop("disabled",!0),s?l?r.val(s):r.val("").change():r.val("")}),a.trigger("woocommerce_update_variation_values")},viwcaio_get_variation.prototype.call_ajax=function(t,i,a,e){t.product_id=e.product_id,e.xhr=jQuery.ajax({url:e.wc_ajax_url.toString().replace("%%endpoint%%","get_variation"),type:"POST",data:t,beforeSend:function(){a.closest(".vi-wcaio-va-cart-form-wrap").addClass("vi-wcaio-container-loading")},success:function(o){e.show_variation(e,o,a),o&&(i[i.length||0]=o),delete t.product_id},complete:function(){a.closest(".vi-wcaio-va-cart-form-wrap").removeClass("vi-wcaio-container-loading")}})},viwcaio_get_variation.prototype.show_variation=function(t,i,a){if(i){let e=!0;i.is_purchasable&&i.is_in_stock&&i.variation_is_visible||(e=!1),e?(t.set_add_to_cart(i.variation_id,a),a.find(".vi-wcaio-product-bt-atc").removeClass("vi-wcaio-button-swatches-disable")):(t.set_add_to_cart("",a),a.find(".vi-wcaio-product-bt-atc").addClass("vi-wcaio-button-swatches-disable")),a.trigger("viwpvs_show_variation",[i,e])}else t.set_add_to_cart("",a),a.find(".vi-wcaio-product-bt-atc").addClass("vi-wcaio-button-swatches-disable"),a.trigger("viwpvs_hide_variation")},viwcaio_get_variation.prototype.set_add_to_cart=function(t,i){t=t||0,i.find(".variation_id").val(t)},viwcaio_get_variation.prototype.check_is_equal=function(t,i){let a=Object.getOwnPropertyNames(t),e=Object.getOwnPropertyNames(i);if(a.length!==e.length)return!1;for(let e=0;e<a.length;e++){let o=a[e],n=t[o],r=i[o];if(void 0!==n&&void 0!==r&&0!==n.length&&0!==r.length&&n!==r)return!1}return!0};